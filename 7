
import matplotlib.pyplot as plt, numpy as np
from sklearn.datasets import load_iris
from sklearn.linear_model import LinearRegression 
from sklearn.preprocessing import PolynomialFeatures 
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error as MSE

# 1. Data: Predict Petal Width (col 3) from Petal Length (col 2)
# We use slicing [:, 2:3] to keep X as 2D array, which sklearn requires
data = load_iris()
x= data.data[:, 2:3]
y= data.data[:, 3]
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=42)

# 2. Loop Degrees 1-10
tr_err, val_err, degs = [], [], range(1, 11)
for d in degs:
    poly = PolynomialFeatures(d, include_bias=False)
    # Fit poly features on training data
    model = LinearRegression().fit(poly.fit_transform(x_train), y_train)
    # Record MSE for Train and Validation
    tr_err.append(MSE(y_train, model.predict(poly.transform(x_train))))
    val_err.append(MSE(y_test, model.predict(poly.transform(x_test))))

# 3. Plot
plt.plot(degs, tr_err, label='Train'); plt.plot(degs, val_err, label='Val')
plt.xlabel("Degree"); plt.ylabel("MSE"); plt.legend(); plt.show()

print(f"Best Degree: {degs[np.argmin(val_err)]}")
